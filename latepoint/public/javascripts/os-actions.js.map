{"version":3,"sources":["../../lib/assets/javascripts/os-actions.js"],"names":[],"mappings":"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","file":"os-actions.js","sourcesContent":["function latepoint_generate_form_message_html(messages, status){\n  var message_html = '<div class=\"os-form-message-w status-' + status + '\"><ul>';\n  if(Array.isArray(messages)){\n    messages.forEach(function(message){\n      message_html+= '<li>' + message + '</li>';\n    });\n  }else{\n    message_html+= '<li>' + messages + '</li>';\n  }\n  message_html+= '</ul></div>';\n  return message_html;\n}\n\nfunction latepoint_clear_form_messages($form){\n  $form.find('.os-form-message-w').remove();\n}\n\nfunction latepoint_show_data_in_lightbox(message, extra_classes = ''){\n  jQuery('.latepoint-lightbox-w').remove();\n  var lightbox_css_classes = 'latepoint-lightbox-w latepoint-w ';\n  if(extra_classes) lightbox_css_classes+= extra_classes;\n  jQuery('body').append('<div class=\"'+ lightbox_css_classes +'\"><div class=\"latepoint-lightbox-i\">' + message + '<a href=\"#\" class=\"latepoint-lightbox-close\"><i class=\"latepoint-icon latepoint-icon-x\"></i></a></div><div class=\"latepoint-lightbox-shadow\"></div></div>');\n  jQuery('body').addClass('latepoint-lightbox-active');\n}\n\n\n\n// DOCUMENT READY\njQuery(document).ready(function( $ ) {\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  /* \n    Ajax buttons action\n  */\n  $('.latepoint').on('click', 'button[data-os-action], a[data-os-action], div[data-os-action], span[data-os-action]', function(e){\n    var $this = $(this);\n    if($this.data('os-prompt') && !confirm($this.data('os-prompt'))) return false;\n    var params = $(this).data('os-params');\n    if($(this).data('os-source-of-params')){\n      params = $($(this).data('os-source-of-params')).find('select, input, textarea').serialize();\n    }\n    var return_format = $this.data('os-return-format') ? $this.data('os-return-format') : 'json'\n    var data = { action: 'latepoint_route_call', route_name: $(this).data('os-action'), params: params, return_format: return_format } \n    $this.addClass('os-loading');\n    $.ajax({\n      type : \"post\",\n      dataType : \"json\",\n      url : latepoint_helper.ajaxurl,\n      data : data,\n      success: function(response){\n        if(response.status === \"success\"){\n          if($this.data('os-output-target') == 'lightbox'){\n            latepoint_show_data_in_lightbox(response.message, $this.data('os-lightbox-classes'));\n          }else if($this.data('os-output-target') == 'side-panel'){\n            $('.latepoint-side-panel-w').remove();\n            $('body').append('<div class=\"latepoint-side-panel-w\"><div class=\"latepoint-side-panel-i\">' + response.message + '</div><div class=\"latepoint-side-panel-shadow\"></div></div>');\n          }else if($this.data('os-success-action') == 'reload'){\n            latepoint_add_notification(response.message);\n            location.reload();\n            return;\n          }else if($this.data('os-success-action') == 'redirect'){\n            if($this.data('os-redirect-to')){\n              latepoint_add_notification(response.message);\n              window.location.replace($this.data('os-redirect-to'));\n            }else{\n              window.location.replace(response.message); \n            }\n            return;\n          }else if($this.data('os-output-target') && $($this.data('os-output-target')).length){\n            if($this.data('os-output-target-do') == 'append'){\n              $($this.data('os-output-target')).append(response.message);\n            }else{\n              $($this.data('os-output-target')).html(response.message);\n            }\n          }else{\n            if($this.data('os-before-after') == 'before'){\n              $this.before(response.message);\n            }else if($this.data('os-before-after') == 'before'){\n              $this.after(response.message);\n            }else{\n              latepoint_add_notification(response.message);\n            }\n          }\n          if($this.data('os-after-call')){\n            var func_name = $this.data('os-after-call');\n            if($this.data('os-pass-this')){\n              window[func_name]($this);\n            }else if($this.data('os-pass-response')){\n              window[func_name](response);\n            }else{\n              window[func_name]();\n            }\n          }\n          $this.removeClass('os-loading');\n        }else{\n          $this.removeClass('os-loading');\n          if($this.data('os-output-target') && $($this.data('os-output-target')).length){\n            $($this.data('os-output-target')).prepend(latepoint_generate_form_message_html(response.message, 'error'));\n          }else{\n            alert(response.message);\n          }\n        }\n      }\n    });\n    return false;\n  });\n\n\n  $('.latepoint').on('click', 'form[data-os-action] button[type=\"submit\"]', function(e){\n    $(this).addClass('os-loading');\n  });\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  /* \n    Form ajax submit action\n  */\n  $('.latepoint').on('submit', 'form[data-os-action]', function(e){\n    e.preventDefault(); // prevent native submit\n    var $form = $(this);\n    var form_data = $form.serialize();\n    var data = { action: 'latepoint_route_call', route_name: $(this).data('os-action'), params: form_data, return_format: 'json' }\n    $form.find('button[type=\"submit\"]').addClass('os-loading');\n    $.ajax({\n      type : \"post\",\n      dataType : \"json\",\n      url : latepoint_helper.ajaxurl,\n      data : data,\n      success: function(response){\n        $form.find('button[type=\"submit\"].os-loading').removeClass('os-loading');\n        latepoint_clear_form_messages($form);\n        if(response.status === \"success\"){\n          if($form.data('os-success-action') == 'reload'){\n            latepoint_add_notification(response.message);\n            location.reload();\n            return;\n          }else if($form.data('os-success-action') == 'redirect'){\n            if($form.data('os-redirect-to')){\n              latepoint_add_notification(response.message);\n              window.location.replace($form.data('os-redirect-to'));\n            }else{\n              window.location.replace(response.message);\n            }\n            return;\n          }else if($form.data('os-output-target') && $($form.data('os-output-target')).length){\n            $($form.data('os-output-target')).html(response.message);\n          }else{\n            if(response.message == 'redirect'){\n              window.location.replace(response.url);\n            }else{\n              latepoint_add_notification(response.message);\n              $form.prepend(latepoint_generate_form_message_html(response.message, 'success'));\n            }\n          }\n          if($form.data('os-record-id-holder') && response.record_id){\n            $form.find('[name=\"' + $form.data('os-record-id-holder') + '\"]').val(response.record_id)\n          }\n          if($form.data('os-after-call')){\n            var func_name = $form.data('os-after-call');\n            if($form.data('os-pass-response')){\n              window[func_name](response);\n            }else{\n              window[func_name]();\n            }\n          }\n          if(response.form_values_to_update){\n            $.each(response.form_values_to_update, function(name, value){\n              $form.find('[name=\"'+ name +'\"]').val(value);\n            });\n          }\n          $('button.os-loading').removeClass('os-loading');\n        }else{\n          $('button.os-loading').removeClass('os-loading');\n          if($form.data('os-show-errors-as-notification')){\n            latepoint_add_notification(response.message, 'error');\n          }else{\n            $form.prepend(latepoint_generate_form_message_html(response.message, 'error'));\n            $([document.documentElement, document.body]).animate({\n                scrollTop: ($form.find(\".os-form-message-w\").offset().top - 30)\n            }, 200);\n          }\n        }\n      }\n    });\n    return false;\n  });\n});"]}